-- title:  UniTIC (3D Engine)
-- author: HanamileH
-- desc:   version 1.3 (unfinished)
-- By HanamileH | hanamileh@gmail.com | discord: HanamileH#8604
-- script: lua

--we kindly ask you to specify the name of this engine if you use it for your projects

--[[
license:

Copyright 2022 HanamileH
Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files
(the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge,
publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so,
subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO
THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF
CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER
DEALINGS IN THE SOFTWARE.
]]

--[[
The approximate algorithm of the engine:

during initialization:
	saving some necessary variables (math functions, constants, engine settings, etc.)
	saving all data about objects and models in the 'draw' table

during code execution:
	executing 'unitic.render()' (which then executes the necessary functions)

during the execution of 'unitic.render()':
	executing 'unitic.update()' (which performs most of the math calculations)
	drawing the sky and the ground
	executing 'unitic.draw()' (which draws polygons and does some calculations)

during the execution of 'unitic.update()':
	copying all vertices and polygons from 'draw.world' to 'unitic.poly' without changes
	copying vertices from 'draw.objects' to local variables
	doing the necessary calculations and vertex transformations
	saving the processed vertices in 'unitic.poly'
	copying polygons from 'draw.objects' to 'unitic.poly' taking into account the shifted vertex indexes
	rotating all the points in 'unitic.poly' in the right direction (in other words, calculating the rotation of the camera)

during the execution of 'unitic.draw()':
	copying the necessary values to local variables
	translating the 3d coordinates of the points into 2d
	calculating the actual normal of the polygon
	making sure that the polygon should be drawn
	drawing a polygon if it meets the conditions above
]]

local F,min,max = math.floor,math.min,math.max
local pi  = math.pi
local pi2 = math.pi/2

--camera
local cam = {
	x = 0, y = 128, z = -256, --camera position
	tx = 0, --turning the camera up and down
	ty = pi	--turning the camera left and right
}
--

--engine settings:
local unitic = {
	version = 1.3, --engine version
	fov = 120,   --lens distance to camera (the higher the value, the fewer objects fit into the frame)
	sky_color = 11,
	ground_color = 6,
	--system tables (processed data is stored here)
	poly={}
}

--[[
all polygons are saved here
and by default this table not change

save in the World elements
that will not change

save in Object elements
that will move or rotate

to move or rotate these objects,
change their coordinate values in table

the names are not used by the engine by default 
and are needed for simplified object management

pay attention to how the object models are saved
]]

local draw={
	objects={
		{
		name="UniTIC logo",--object name, not used by the engine
	
		x=0,y=0,z=0, --object coordinates
		tx=0,ty=0,tz=0, --angle of rotation around the axes
		px=32,py=32,pz=32, --the point of rotation of the object
		draw=true, --whether to display the model
		scale=1, --model size
		model={
			v={ --vertexes
				{-64,128,-64}, --X Y Z coordinates
				{-64,0,-64},
				{-64,21,-44},
				{64,128,-64},
				{64,0,-64},
				{64,128,-44},
				{-64,0,-44},
				{-64,127,64},
				{47,128,-44},
				{-64,21,47},
				{64,128,63},
				{-64,0,63},
				{-64,128,47},
				{47,128,47},
				{47,128,-44},
				{47,128,47},
				{-64,128,47},
			},
			f={ --polygons (faces)
				{1,5,2, --vertex id
				uv={ --uv coordinates for textures
					{0,0}, --X Y of the first point
					{0,1},
					{1,0},
					-1}, --background color
					f=3}, --polygon normal
					--[[
						f=0 - polygon is not displayed
						f=1 - standard normal
						f=2 - reverse normal
						f=3 - both sides of the polygon are drawn
					]]
	
				{10,7,12,uv={{0,0},{0,1},{1,0},-1},f=3},
				{14,6,9,uv={{0,0},{0,1},{1,0},-1},f=3},
				{8,14,13,uv={{0,0},{0,1},{1,0},-1},f=3},
				{8,11,14,uv={{0,0},{0,1},{1,0},-1},f=3},
				{12,8,10,uv={{0,0},{0,1},{1,0},-1},f=3},
				{8,13,10,uv={{0,0},{0,1},{1,0},-1},f=3},
				{14,15,16,uv={{0,0},{0,1},{1,0},-1},f=3},
				{16,15,17,uv={{0,0},{0,1},{1,0},-1},f=3},
				{1,4,5,uv={{0,0},{0,1},{1,0},-1},f=3},
				{10,3,7,uv={{0,0},{0,1},{1,0},-1},f=3},
				{14,11,6,uv={{0,0},{0,1},{1,0},-1},f=3},
				{14,9,15,uv={{0,0},{0,1},{1,0},-1},f=3},
			}
			}
		}
	},
	world={
		v={},f={}
	}
}

function unitic.update() --this is where rotation, scaling and other operations take place

	--we write all vertices and polygons in the system table
	unitic.poly={v={},f={}}

	--first we take vertices and polygons from the draw.world table, simply duplicating the values
	for ind=1,#draw.world.v do --vertices
		unitic.poly.v[ind]={draw.world.v[ind][1],draw.world.v[ind][2],draw.world.v[ind][3]}
	end

	for ind=1,#draw.world.f do --polygons (faces)
		unitic.poly.f[ind]={draw.world.f[ind][1],draw.world.f[ind][2],draw.world.f[ind][3],f=draw.world.f[ind].f,uv=draw.world.f[ind].uv}
	end

	--we do the same with draw.objects, but before that we rotate, move and scale the objects
	if #draw.objects>0 then --if there are objects..
		for ind1=1,#draw.objects do  --the first loop responsible for the index of the object
			if draw.objects[ind1].draw then --if the object needs to be drawn..
				local vt=#unitic.poly.v --index of the last vertex, its necessary that vertices with the save index for different

				--(so as not to recalculate it again)
				local txsin=math.sin(draw.objects[ind1].tx)
				local txcos=math.cos(draw.objects[ind1].tx)
				local tysin=math.sin(-draw.objects[ind1].ty)
				local tycos=math.cos(-draw.objects[ind1].ty)
				local tzsin=math.sin(draw.objects[ind1].tz)
				local tzcos=math.cos(draw.objects[ind1].tz)

				for ind2=1,#draw.objects[ind1].model.v do --the second loop, responsible for the index of the vertex of a particular model

					--vertex coordinates
					local px=draw.objects[ind1].model.v[ind2][1]
					local py=draw.objects[ind1].model.v[ind2][2]
					local pz=draw.objects[ind1].model.v[ind2][3]

					--here there is a rotation (on each plane in turn)

					--temporarily subtract the coordinates of the pivot point so that the model rotates around it
					local a1=px-draw.objects[ind1].px
					local b1=py-draw.objects[ind1].py
					local c1=pz-draw.objects[ind1].pz
					--rotation in the XY plane
					local a2=a1*tzcos-b1*tzsin
					local b2=a1*tzsin+b1*tzcos
					local c2=c1
					--rotation in the XZ plane
					local c3=c2*tycos-a2*tysin
					local a3=c2*tysin+a2*tycos
					local b3=b2
					--rotation in the YZ plane
					px=a3
					py=b3*txcos-c3*txsin
					pz=b3*txsin+c3*txcos
					--scaling and moving the model to the specified location
					px=px*draw.objects[ind1].scale+draw.objects[ind1].px+draw.objects[ind1].x
					py=py*draw.objects[ind1].scale+draw.objects[ind1].py+draw.objects[ind1].y
					pz=pz*draw.objects[ind1].scale+draw.objects[ind1].pz+draw.objects[ind1].z
					--writing down the vertex
					table.insert(unitic.poly.v,{px,py,pz})
				end
				--copying the polygons of the objects
				for ind2=1,#draw.objects[ind1].model.f do
				table.insert(unitic.poly.f,{
					draw.objects[ind1].model.f[ind2][1]+vt, --don't forget about the offset index of vertices
					draw.objects[ind1].model.f[ind2][2]+vt,
					draw.objects[ind1].model.f[ind2][3]+vt,
					f=draw.objects[ind1].model.f[ind2].f,
					uv=draw.objects[ind1].model.f[ind2].uv})
				end
			end
		end
	end
	
	--not rotate the vertices around the camera

	--a little calculation in advance
	local txsin=math.sin(cam.tx)
	local txcos=math.cos(cam.tx)
	local tysin=math.sin(-cam.ty)
	local tycos=math.cos(-cam.ty)
	
	for ind=1,#unitic.poly.v do
		--[[
			we rotate objects using the same method as above
			but without rotation along the XY plane and with fewer calculation
		]]
		local a1=unitic.poly.v[ind][1]-cam.x
		local b1=unitic.poly.v[ind][2]-cam.y
		local c1=unitic.poly.v[ind][3]-cam.z

		local c2=c1*tycos-a1*tysin --intermediate value (so as not to count twice)

		unitic.poly.v[ind][1]=c1*tysin+a1*tycos
		unitic.poly.v[ind][2]=b1*txcos-c2*txsin
		unitic.poly.v[ind][3]=b1*txsin+c2*txcos
	end
end

function unitic.draw() --polygons are drawn here
	for i=1,#unitic.poly.f do --the loop responsible for the polygon index

		local v_ind={unitic.poly.f[i][1],unitic.poly.f[i][2],unitic.poly.f[i][3]} --index of the vertices of this polygon

		--coordinates of polygon points
		local px={unitic.poly.v[v_ind[1]][1],unitic.poly.v[v_ind[2]][1],unitic.poly.v[v_ind[3]][1]}
		local py={unitic.poly.v[v_ind[1]][2],unitic.poly.v[v_ind[2]][2],unitic.poly.v[v_ind[3]][2]}
		local pz={min(unitic.poly.v[v_ind[1]][3],-0.01),min(unitic.poly.v[v_ind[2]][3],-0.01),min(unitic.poly.v[v_ind[3]][3],-0.01)} --because dividing by 0 is not the best idea

		--2d coordinates
		local p2d={x={},y={}}

		--uv textures
		local uv=unitic.poly.f[i].uv

		--convert each point into 2d space
		for p=1,3 do
			local x0=px[p]
			local y0=py[p]
			local z0=pz[p]
			p2d.x[p]=F(unitic.fov*x0/z0+120)
			p2d.y[p]=F(unitic.fov*y0/z0+68)
		end
		
		--the actual normal of the polygon
		local tri_face=(p2d.x[2]-p2d.x[1])*(p2d.y[3]-p2d.y[1])-(p2d.x[3]-p2d.x[1])*(p2d.y[2]-p2d.y[1])<0

		--we exclude polygons that should not be visible
		if unitic.poly.f[i].f~=0 and
			(tri_face and unitic.poly.f[i].f==1)==false and
			(not tri_face and unitic.poly.f[i].f==2)==false and
			(unitic.poly.v[v_ind[1]][3]>0 and unitic.poly.v[v_ind[2]][3]>0 and unitic.poly.v[v_ind[3]][3]>0)==false and--checking if all Z coordinates are behind the screen
			(p2d.x[1]<0   and p2d.x[2]<0   and p2d.x[3]<0)==false and
			(p2d.y[1]<0   and p2d.y[2]<0   and p2d.y[3]<0)==false and
			(p2d.x[1]>240 and p2d.x[2]>240 and p2d.x[3]>240)==false and
			(p2d.y[1]>136 and p2d.y[2]>136 and p2d.y[3]>136)==false
		then
			ttri(
				p2d.x[1],p2d.y[1],
				p2d.x[2],p2d.y[2],
				p2d.x[3],p2d.y[3],
				
				uv[1][1],uv[1][2],
				uv[2][1],uv[2][2],
				uv[3][1],uv[3][2],
				0,uv[4],
				-pz[1],-pz[2],-pz[3])
		end
	end
end

function unitic.render()
	--updating objects
	unitic.update()
	--sky display (optional)
	cls(unitic.sky_color)
	--this complicated math just makes the height of the ground proportionally equal to the angle of rotation of the camera
	rect(0,min(max(68.5-134*cam.tx,0),136),240,137-min(max(68.5-134*cam.tx,0),136),unitic.ground_color)
	--drawing triangles
	unitic.draw()
end



local fps = 0
local t1 = 0
local t2 = 0
local t = 0
local speed = 4

function TIC()
	poke(0x7FC3F,1,1)
	--inaccurate fps counter
	t1=time()
	t=t+1
	--an example of how to make the camera move
	--(many elements are not perfect)
	mx,my=mouse()
	--W A S D
	if key(23) then cam.z=cam.z-math.cos(cam.ty)*speed     cam.x=cam.x-math.sin(cam.ty)*speed     end
	if key(19) then cam.z=cam.z+math.cos(cam.ty)*speed     cam.x=cam.x+math.sin(cam.ty)*speed     end
	if key(1)  then cam.z=cam.z-math.cos(cam.ty-pi2)*speed cam.x=cam.x-math.sin(cam.ty-pi2)*speed end
	if key(4)  then cam.z=cam.z+math.cos(cam.ty-pi2)*speed cam.x=cam.x+math.sin(cam.ty-pi2)*speed end
	if key(64) then speed=16 else speed=4 end
	if key(48) then cam.y=cam.y+speed end
	if key(63) then cam.y=cam.y-speed end
	--camera
	cam.tx=cam.tx+my/50
	cam.ty=cam.ty+mx/50

	--camera rotation restriction
	cam.tx=max(min(cam.tx,pi2),-pi2)
	--render
	unitic.render()
	--fps counter
	print("fps:  "..fps,1,2,0)
	print("fps:  "..fps,1,1,12)
	print("frame:"..t2.." ms.",1,9,0)
	print("frame:"..t2.." ms.",1,8,12)
	print("v: "..#unitic.poly.v.." f:"..#unitic.poly.f,1,16,0)
	print("v: "..#unitic.poly.v.." f:"..#unitic.poly.f,1,15,12)
	print("X: "..F(cam.x).." Y: "..F(cam.y).." Z: "..F(cam.z),1,23,0)
	print("X: "..F(cam.x).." Y: "..F(cam.y).." Z: "..F(cam.z),1,22,12)
	if t%20==0 then
		t2=time()-t1
		fps=F(1000/(time()-t1))
	end
end
-- <TILES>
-- 000:d000000000000000000000000000000000000000000000000000000000000000
-- </TILES>

-- <SCREEN>
-- 000:bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
-- 001:bbbcccbbbbbbbbbbbbbccbbbbbbbbbcccccbbcccbbbcccbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
-- 002:bbcc00bccccbbbccccbccbbbbbbbbbcc000bcc0ccbcc0ccbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
-- 003:bcccccbcc00cbccc00b00bbbbbbbbbccccbbccc0cbccc0cbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
-- 004:60cc006cc66c600ccc6cc666666666000cc6cc06c6cc06c6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 005:66cc666cccc06cccc06cc666666666cccc060ccc060ccc06666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 006:6600666cc006600006600666666666000066600066600066666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 007:666666600666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 008:666ccc6666666666666666666666666cc6cccc666666ccc6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 009:66cc006cccc666cccc6cc6c666ccc66cc6000cc6666cc0cc66666cc6c666cccc66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 010:6ccccc6cc00c6c00cc6ccccc6cc0cc60066ccc06666ccc0c66666ccccc6ccc0066666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 011:60cc006cc6606c66cc6c0c0c6ccc006cc6cc0066cc6cc06c66666c0c0c600ccc6cc66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 012:66cc666cc66660cccc6c6c6c60ccc66cc6ccccc6cc60ccc066666c6c6c6cccc06cc66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 013:660066600666660000606060660006600600000600660006666660606060000660066666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 014:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 015:6666666cc666666cc66ccccc6666666ccc6cc66cc66ccccc666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 016:6cc66c6cc66666ccc66000cc666666cc006cc6ccc66000cc666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 017:6cc66c600666660cc6666cc066666ccccc60060cc6666cc0666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 018:60ccc06cc666666cc666cc06666660cc006cc66cc66c60cc666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 019:660c066cc66666cccc6cc066666666cc666cc6cccc60ccc0666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 020:666066600666660000600666666666006660060000660006666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 021:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 022:6cc66c6cc666666666ccccc6ccccc66666cc6c6cc666666cc66ccccc66ccc666666ccccc6cc666666666cccc666ccc666ccc66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 023:6cc66c6cc666666666cc0006000cc66666cc6c6cc66666ccc66000cc6cc0066666600cc06cc666666666000cc6cc00c6cc0cc6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 024:60ccc060066666ccc6cccc6666cc066666cccc600666660cc6666cc06cccc6666666cc0660066666ccc66ccc060ccc06ccc0c6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 025:6cc00c6cc666660006000cc66cc06666660cc06cc666666cc666cc066cc00c66666cc0666cc666660006cc0066cc00c6cc06c66666666dddddddddddddddddddddddddddddddddddddddddddddddd66666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 026:6cc66c6cc666666666cccc06cc066666666cc66cc66666cccc6cc06660ccc066666ccccc6cc666666666ccccc60ccc060ccc0666666666666ddddddddddddddddddddddddddddddddddddddddddddddd66666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 027:6006606006666666660000660066666666600660066666000060066666000666666000006006666666660000066000666000666666666666666666666ddddddddddddddddddddddddddddddddddddddddd666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 028:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666666666666666666666666666666666666666
-- 029:66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddd6666666666666666666666666666666666666666666666666666666666666666666666666
-- 030:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddd66666666666666666666666666666666666666666666666666666666666666666666666
-- 031:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddd66666666666666666666666666666666666666666666666666666666666666666666
-- 032:66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddd66666666666666666666666666666666666666666666666666666666666666666666666
-- 033:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 034:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 035:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666d666666666666666666666666666666666ddddddddddddddddddddddddddddddddddd66666666666666666666666666666666666666666666666666666666666666
-- 036:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd66666666666666666666666666666666666666666666666666666666666666
-- 037:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd666666666666666666666666666666666666666666666666666666666666666
-- 038:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd666666666666666666666666666666666666666666666666666666666666666
-- 039:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd666666666666666666666666666666666666666666666666666666666666666
-- 040:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd666666666666666666666666666666666666666666666666666666666666666
-- 041:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd666666666666666666666666666666666666666666666666666666666666666
-- 042:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666666666666666666666666666
-- 043:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666666666666666666666666666
-- 044:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666666666666666666666666666
-- 045:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666666666666666666666666666
-- 046:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666666666666666666666666666
-- 047:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd66666666666666666666666666666666666666666666666666666666666666666
-- 048:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd66666666666666666666666666666666666666666666666666666666666666666
-- 049:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd66666666666666666666666666666666666666666666666666666666666666666
-- 050:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd66666666666666666666666666666666666666666666666666666666666666666
-- 051:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd666666666666666666666666666666666666666666666666666666666666666666
-- 052:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd666666666666666666666666666666666666666666666666666666666666666666
-- 053:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd666666666666666666666666666666666666666666666666666666666666666666
-- 054:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd666666666666666666666666666666666666666666666666666666666666666666
-- 055:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd666666666666666666666666666666666666666666666666666666666666666666
-- 056:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666666666666666666666666666666
-- 057:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666666666666666666666666666666
-- 058:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666666666666666666666666666666
-- 059:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666666666666666666666666666666
-- 060:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666666666666666666666666666666
-- 061:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd66666666666666666666666666666666666666666666666666666666666666666666
-- 062:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd66666666666666666666666666666666666666666666666666666666666666666666
-- 063:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd66666666666666666666666666666666666666666666666666666666666666666666
-- 064:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd66666666666666666666666666666666666666666666666666666666666666666666
-- 065:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd666666666666666666666666666666666666666666666666666666666666666666666
-- 066:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd666666666666666666666666666666666666666666666666666666666666666666666
-- 067:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd666666666666666666666666666666666666666666666666666666666666666666666
-- 068:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd666666666666666666666666666666666666666666666666666666666666666666666
-- 069:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd666666666666666666666666666666666666666666666666666666666666666666666
-- 070:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666666666666666666666666666666666
-- 071:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666666666666666666666666666666666
-- 072:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666666666666666666666666666666666
-- 073:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666666666666666666666666666666666
-- 074:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666666666666666666666666666666666
-- 075:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd66666666666666666666666666666666666666666666666666666666666666666666666
-- 076:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd66666666666666666666666666666666666666666666666666666666666666666666666
-- 077:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd66666666666666666666666666666666666666666666666666666666666666666666666
-- 078:6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd66666666666666666666666666666666666666666666666666666666666666666666666
-- 079:66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddd666666666666666666666666666666666666666666666666666666666666666666666666
-- 080:66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddd666666666666666666666666666666666666666666666666666666666666666666666666
-- 081:66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddd666666666666666666666666666666666666666666666666666666666666666666666666
-- 082:66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddd666666666666666666666666666666666666666666666666666666666666666666666666
-- 083:66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddddd666666666666666666666666666666666666666666666666666666666666666666666666
-- 084:66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666666666666666666666666666666666666
-- 085:66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666666666666666666666666666666666666
-- 086:66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666666666666666666666666666666666666
-- 087:66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666666666666666666666666666666666666
-- 088:66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666ddddddddddddddddddddddddddddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666666666666666666666666666666666666
-- 089:66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddd66666666666666666666666666666666666666666666666666666666666666666666666666
-- 090:66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddddddddddddddddd66666666666666666666666666666666666666666666666666666666666666666666666666
-- 091:66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddddddddddddddddddddddddddddddd6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 092:66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666dddddddddddddd66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 093:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 094:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 095:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 096:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 097:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 098:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 099:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 100:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 101:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 102:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 103:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 104:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 105:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 106:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 107:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 108:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 109:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 110:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 111:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 112:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 113:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 114:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 115:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 116:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 117:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 118:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 119:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 120:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 121:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 122:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 123:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 124:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 125:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 126:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 127:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 128:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 129:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 130:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 131:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 132:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 133:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 134:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- 135:666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666
-- </SCREEN>

-- <PALETTE>
-- 000:1a1c2c5d275db13e53ef7d57ffbe75a7f07038b76425717929366f3b5dc941a6f673eff7f4f4f494b0c2566c86333c57
-- </PALETTE>

